# Ніндзя код


```quote author="Конфуцій (Бесіди і судження)"
Навчання без міркування — даремне, міркування без навчання — небезпечне.
```

Ніндзя-програмісти минулого використовували ці хитрощі, щоб загострити розум тих, хто буде підтримувати їхній код.

Ґуру, що перевіряють код, шукають їх у тестових завданнях.

Початківці часом використовують їх навіть краще за ніндзя-програмістів.

Уважно перечитайте ці хитрощі і вирішіть, хто ви є — ніндзя, початківець, чи може ґуру перевірки коду?


```warn header="Обережно, іронія!"
Багато тих, хто намагався піти шляхом ніндзя. Мало тих, кому це вдалося.
```


## Стислість — сестра таланту

Пишіть якомога коротший код. Покажіть, наскільки ви розумні.

Нехай неочевидні мовні нюанси керують вами.

Наприклад, розглянемо застосування тернарного оператора `'?'`:

```js
// взято з добре відомої javascript бібліотеки
i = i ? i < 0 ? Math.max(0, len + i) : i : 0;
```

Круто, справді? Якщо ви напишете щось подібне, то розробник, який натрапить на цей рядок і намагатиметься зрозуміти, яке ж значення має `i`, пізнає неабияку радість. І, врешті-решт, прийде до вас за відповіддю.

Скажіть йому, що коротше — це завжди краще. Допоможіть йому стати на шлях ніндзя.

## Однолітерні змінні

```quote author="Лао-цзи (Дао де цзін)"
Дао безсловесне.
Ім’я, яке можна назвати, не є постійним ім’ям.
```

Ще один спосіб писати стислий код — використовувати однолітерні змінні. Наприклад: `a`, `b` або `c`.

Коротка змінна зникає у коді, наче ніндзя у лісі. Ніхто не зможе знайти її використовуючи "пошук" редактора. І навіть якщо її знайдуть, вони не зможуть "розшифрувати" за що саме змінні `a` чи `b` відповідають.

...Але є один виняток із правил. Справжній ніндзя ніколи не використовуватиме `i` у якості лічильника в циклі `"for"`. Де завгодно, тільки не тут! Озирніться — є багато інших екзотичних літер. Наприклад, `x` або `y`.

Екзотична змінна у ролі лічильника особливо доречна, коли тіло циклу займає одну-дві сторінки (чим більше, тим краще). У такому випадку ті, хто зануриться глибоко у код циклу, не зможуть швидко здогадатись, що змінна `x` насправді є лічильником.

## Використовуйте абревіатури

Якщо правила, встановлені командою, не дозволяють вам використовувати однолітерні змінні або абстрактні імена, тоді скоротшуйте їх.

Наприклад:

- `list` -> `lst`.
- `userAgent` -> `ua`.
- `browser` -> `brsr`.
- ...тощо.

Тільки обрані, що мають добре розвинену інтуїцію, зможуть зрозуміти такі імена. Намагайтесь скоротшувати все. Тільки гідні повинні мати змогу підтримувати ваш код.

## Будьте абстрактними

```quote author="Лао-цзи (Дао де цзін)"
Великий квадрат не має кутів,
Великий глек довго ліпиться,
Великий звук не можна почути,
Великий образ неозорий.
```

Обираючи ім’я, намагайтесь використовувати найбільш абстрактне слово. Прикладом може бути `obj`, `data`, `value`, `item`, `elem` тощо.

- **`data` є ідеальним варіантом для назви змінної.** Використовуйте його всюди, де можете. І справді, кожна змінна має *дані*, вірно?

    ...А що робити, якщо назва `data` вже зайнята? Спробуйте `value` — вона також універсальна. Врешті-решт, кожна змінна набуває якесь *значення*.

- **Добирайте ім’я змінним згідно з їхнім типом: `str`, `num`...**

    Спробуйте. Той, що щойно став на шлях ніндзя, може засумніватися чи дійсно вони такі корисні. Авжеж!

    Так, ім’я змінної дещо означає. Це допомагає зрозуміти, що ми використовуємо: рядок, число, чи щось ще. Проте коли сторонні люди намагатимуться зрозуміти код, вони будуть здивовані, що інформація про те, що саме містить змінна, відсутня. У результаті вони не зможуть змінити ваш добре обміркований код.

    Тип змінної досить легко знайти під час налаштування. Але що означає назва змінної? Яку саме строку/число вона зберігає?

    Жодного шансу дізнатися про це без тривалої медитації!

- **...Але що робити, коли і такі імена закінчились?** Просто додайте число: `data1, item2, elem5`...

## Перевірка уваги

Тільки дуже уважний програміст повинен мати змогу зрозуміти ваш код. Проте як це перевірити? 

**Один із способів — використання схожих імен змінних, наприклад `date` і `data`.**

Змішуйте їх всюди, де це можливо.

Швидко прочитати такий код неможливо. А якщо стався хибодрук... Мммм... Це надовго, час випити чаю.


## Хитромудрі синоніми

```quote author="Лао-цзи (Дао де цзін)"
Істина, яка може бути виражена словами, не є правдива істина. Ім’я, яке може бути названо, не є правдиве ім’я.
```

Використання *схожих* імен для *однакових* речей зробить життя цікавішим і продемонструє рівень вашої креативності.

Наприклад, розглянемо префікси функцій. Якщо функція виводить повідомлення на екран — почніть назву з `display…`, як то `displayMessage`. А для іншої функції, що показуватиме ще щось на екрані (скажімо, ім’я користувача), оберіть назву з `show…` (наприклад, `showName`).

Натякніть, що є деяка тонка відмінність між цими функціями, хоча насправді її немає.

Домовтесь зі своїми ніндзя-колегами, що якщо Іван починає називати функції, що показують щось, використовуючи `display...`, тоді Петро може використовувати `render..`, а Ганна — `paint...`. Зауважте, наскільки цікавим та різноманітним став код.

...А тепер коронний прийом!

Для функцій, у яких дійсно є важливі відмінності, використовуйте однаковий префікс!

Наприклад, функція `printPage(page)` використовуватиме принтер. А `printText(text)` виводитиме текст на екран. Нехай люди, що неосвічені у вашому коді, розмірковують щодо схожої функції `printMessage`: "Куди буде виведено повідомлення? На принтер чи на екран?". Будьте послідовними, функція `printMessage(message)` повинна вивести повідомлення в нове вікно!

## Використовуйте імена повторно

```quote author="Лао-цзи (Дао де цзін)"
При встановленні порядку
з’явилися імена.
Оскільки виникли імена,
потрібно знати межу їх використання.
```

Вводіть нову змінну тільки тоді, коли це вкрай необхідно.

Натомість, використовуйте наявні змінні повторно. Просто записуйте у них нові значення.

У функції намагайтесь використовувати лише змінні, що були передані у якості параметрів.

Це суттєво ускладнить розуміння того, що саме міститься у змінній *зараз*, і звідки воно там. Метою цих дій є розвиток інтуїції та пам’яті людини, котра читає цей код. Людина зі слабкою інтуїцією аналізуватиме такий код рядок за рядком і слідкуватиме за змінами у кожному блоці коду.

**Просунутим варіантом такого підходу є непомітна (!) заміна значення змінної на щось дуже схоже всередині циклу або функції.**

Наприклад:

```js
function ninjaFunction(elem) {
  // 20 рядків коду, що використовують elem

  elem = clone(elem);

  // ще 20 рядків, які тепер використовують клон elem!
}
```

Колега-програміст, в якого буде бажання використати `elem` у другій частині коду, буде здивований... Тільки під час налагодження, після розбору коду він зрозуміє, що працює з клоном!

Таке трапляється доволі часто. Вбивчий прийом, навіть проти досвідчених ніндзя.

## Підкреслення задля розваги

Ставте підкреслення `_` та `__` перед іменами змінних. Наприклад, `_name` або `__value`. Краще буде, якщо тільки ви будете розуміти їхнє значення. А ще краще, щоб значення не було зовсім, додавайте їх задля розваги. Або використовуйте різні значення у різних місцях.

Ви вбиваєте двох зайців одним пострілом. По-перше, код стає довшим і менш зрозумілим, і, по-друге, колега-розробник зможе витратити час з’ясовуючи сакральне значення вашого підкреслення.

Проворний ніндзя використовує підкреслення в одній частині коду і уникає їх в іншій. Це робить код ще більш вразливим і підвищує можливість виникнення помилок у майбутньому.

## Покажіть свою любов

Нехай усі бачать, наскільки величні ваші сутності! Читач обов’язково зрадіє таким іменам, як `superElement`, `megaFrame` та `niceItem`.

Справді, з одного боку, дещо все ж таки написано: `super..`, `mega..`, `nice..`. Але, з іншого боку — це не пояснює нічого. Той, хто читатиме ваш код, витратить не одну годину свого оплаченого робочого часу на медитацію і пошуки прихованого значення цих слів.


## Перекриття зовнішніх змінних

```quote author="Ґуань Їнь-цзи"
Той, що перебуває на світлі, не може нічого побачити в темряві.
Той, що перебуває у темряві, побачить все, що перебуває на світлі.
```

Використовуйте ті ж самі імена змінних всередині функцій, що й за її межами. Це просто. Ніяких зусиль для винаходу нових імен.

```js
let *!*user*/!* = authenticateUser();

function render() {
  let *!*user*/!* = anotherValue();
  ...
  ...багато рядків...
  ...
  ... // <-- програміст захоче використати тут 'user' і...
  ...
}
```

Програмісти, що читатимуть код функції `render`, ймовірно не помітять, що локальна змінна `user` перекриває глобальну.

Тоді вони спробують працювати з `user`, як з зовнішньою змінною, що має вернути результат `authenticateUser()`... Пастка захлопнулась! Привіт, налагоджувачу...


## Побічні ефекти всюди!

Є функції, які начебто нічого не змінюють. Наприклад: `isReady()`, `checkPermission()`, `findTags()`... Припускається, що такі функції виконують обчислення та повертають результат без впливу на те, що міститься за межами функції. Іншими словами, без "побічних ефектів".

**Дійсно гарним прийомом є додавати "корисну" дію до них, окрім їхньої основної задачі.**

Вираз приголомшеного подиву на обличчі вашого колеги, коли він побачить, що функція з ім’ям `is..`, `check..` чи `find...` щось змінює, неодмінно розширить межі його розуму.

**Іншим способом здивувати є повернення нестандартного результату.**

Покажіть своє оригінальне мислення! Нехай виклик функції `checkPermission` поверне не `true/false`, а складний об’єкт з результатом перевірки.

Розробники, що намагатимуться написати `if (checkPermission(..))`, будуть дивуватись, чому воно не працює. Скажіть їм: "Читайте документацію!". І дайте їм почитати цю статтю.


## Могутні функції!

```quote author="Лао-цзи (Дао де цзін)"
Вічне Дао пронизує Собою все.
Воно є і праворуч, і ліворуч.
```

Не треба обмежувати алгоритм функції лише тим, що пов’язано з її ім’ям. Мисліть ширше.

Наприклад, функція `validateEmail(email)` може (окрім перевірки адреси електронної пошти на відповідність правилам) показувати повідомлення про помилку та пропонувати ввести нову адресу.

Додаткові дії не мусять бути зрозумілими з імені функції. Справжній ніндзя-розробник зробить їх також неочевидними і в самому коді.

**Поєднання декількох дій в одну захищає ваш код від повторного використання.**

Уявіть собі, що інший розробник захоче тільки перевірити адресу електронної пошти без виводу жодних повідомлень. Ваша функція `validateEmail(email)` робить ці обидві дії, тому не підійде йому. Отже, ніхто не потурбує вас під час медитації питаннями щодо цієї функції.

## Підсумки

Всі "поради", зазначені вище, взяті з реального коду... Іноді написаного доволі досвідченими розробниками. Можливо, навіть досвідченішими за вас ;)

- Дотримуйтесь деяких з цих порад — і у вашому коді буде повно несподіванок.
- Дотримуйтесь більшості з цих порад — і ваш код буде дійсно вашим; ніхто не захоче його читати, тим паче — змінювати.
- Дотримуйтесь усіх порад — і ваш код стане неоціненним уроком для молодих розробників, які шукають просвітлення.
